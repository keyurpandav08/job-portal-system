<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>User Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .nav { margin-bottom: 20px; }
        .btn { padding: 10px 15px; margin: 5px; text-decoration: none; border-radius: 4px; display: inline-block; }
        .btn-primary { background: #007bff; color: white; }
        .profile-section { background: #e9ecef; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .application-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 4px; }
        .status-pending { color: #856404; background: #fff3cd; padding: 5px 10px; border-radius: 3px; display: inline-block; }
        .status-accepted { color: #155724; background: #d4edda; padding: 5px 10px; border-radius: 3px; display: inline-block; }
        .status-rejected { color: #721c24; background: #f8d7da; padding: 5px 10px; border-radius: 3px; display: inline-block; }
        .user-detail { margin: 8px 0; }
        .alert { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .alert-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .no-applications { text-align: center; padding: 40px; color: #666; }
    </style>
</head>
<body>
<div class="container">
    <h2>ðŸ‘¤ Applicant Dashboard</h2>

    <!-- Error Message -->
    <div th:if="${error}" class="alert alert-error" th:text="${error}">Error message</div>

    <div class="nav">
        <a th:href="@{/jobs}" class="btn btn-primary">Browse Jobs</a>
        <a th:href="@{/logout}" class="btn btn-primary">Logout</a>
    </div>

    <!-- User Profile Section -->
    <div class="profile-section" th:if="${user}">
        <h3>ðŸ“‹ Your Profile</h3>
        <div class="user-detail"><strong>Username:</strong> <span th:text="${user.username}">username</span></div>
        <div class="user-detail"><strong>Email:</strong> <span th:text="${user.email}">email</span></div>
        <div class="user-detail" th:if="${user.fullName}"><strong>Full Name:</strong> <span th:text="${user.fullName}">full name</span></div>
        <div class="user-detail" th:if="${user.phone}"><strong>Phone:</strong> <span th:text="${user.phone}">phone</span></div>
        <div class="user-detail" th:if="${user.skills}"><strong>Skills:</strong> <span th:text="${user.skills}">skills</span></div>
        <div class="user-detail" th:if="${user.experience}"><strong>Experience:</strong> <span th:text="${user.experience}">experience</span></div>
        <div class="user-detail"><strong>Role:</strong> <span th:text="${user.role?.name}">role</span></div>
        <div class="user-detail"><strong>Member Since:</strong> <span th:text="${user.createdAt}">date</span></div>
        <div class="user-detail"><strong>Total Applications:</strong> <span th:text="${applications != null ? applications.size() : 0}">0</span></div>
    </div>

    <!-- My Applications Section -->
    <h3>ðŸ“„ My Applications</h3>

    <div th:if="${not #lists.isEmpty(applications)}">
        <div th:each="app : ${applications}" class="application-card">
            <h4 th:text="${app.jobTitle}">Job Title</h4>
            <p><strong>Applied On:</strong> <span th:text="${app.appliedAt}">Date</span></p>
            <p><strong>Resume:</strong>
                <a th:href="${app.resumeUrl}" target="_blank" th:text="${app.resumeUrl}">Resume URL</a>
            </p>
            <p><strong>Status:</strong>
                <span th:class="${'status-' + app.status?.toLowerCase()}"
                      th:text="${app.status}">PENDING</span>
            </p>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(applications)}" class="no-applications">
        <p>You haven't applied to any jobs yet.</p>
        <a th:href="@{/jobs}" class="btn btn-primary">Browse Jobs to Apply</a>
    </div>
</div>
</body>
</html>